<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  

  
  <title>Web 应用黑客手册/第四章：映射应用 | Hexo</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="映射应用攻击的第一步是收集和考察应用的核心功能，理解应用。 枚举内容和功能Web 爬虫Burp Suite 爬虫其实就是图遍历。麻烦之处在于有的网页只有在 post 之后才能看到。 robots.txt 是网站根目录下的文件，用于告诉爬虫工具，本站什么路径可以爬虫，什么路径不可以。在该文件中可以发现一下有趣的信息。比如，https:&#x2F;&#x2F;github.com&#x2F;robots.txt，https:&#x2F;&#x2F;w">
<meta property="og:type" content="article">
<meta property="og:title" content="Web 应用黑客手册&#x2F;第四章：映射应用">
<meta property="og:url" content="http://yoursite.com/2020/06/22/Web%20%E5%BA%94%E7%94%A8%E9%BB%91%E5%AE%A2%E6%89%8B%E5%86%8C/%E7%AC%AC%E5%9B%9B%E7%AB%A0%EF%BC%9A%E6%98%A0%E5%B0%84%E5%BA%94%E7%94%A8/index.html">
<meta property="og:site_name" content="Hexo">
<meta property="og:description" content="映射应用攻击的第一步是收集和考察应用的核心功能，理解应用。 枚举内容和功能Web 爬虫Burp Suite 爬虫其实就是图遍历。麻烦之处在于有的网页只有在 post 之后才能看到。 robots.txt 是网站根目录下的文件，用于告诉爬虫工具，本站什么路径可以爬虫，什么路径不可以。在该文件中可以发现一下有趣的信息。比如，https:&#x2F;&#x2F;github.com&#x2F;robots.txt，https:&#x2F;&#x2F;w">
<meta property="og:locale" content="en_US">
<meta property="article:published_time" content="2020-06-22T12:07:19.740Z">
<meta property="article:modified_time" content="2020-06-25T07:50:55.638Z">
<meta property="article:author" content="John Doe">
<meta name="twitter:card" content="summary">
  
    <link rel="alternate" href="/atom.xml" title="Hexo" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  
  
    <link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  
  
<link rel="stylesheet" href="/css/style.css">

<meta name="generator" content="Hexo 4.2.1"></head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">Hexo</a>
      </h1>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS Feed"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="Search"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="http://yoursite.com"></form>
      </div>
    </div>
  </div>
</header>
      <div class="outer">
        <section id="main"><article id="post-Web 应用黑客手册/第四章：映射应用" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2020/06/22/Web%20%E5%BA%94%E7%94%A8%E9%BB%91%E5%AE%A2%E6%89%8B%E5%86%8C/%E7%AC%AC%E5%9B%9B%E7%AB%A0%EF%BC%9A%E6%98%A0%E5%B0%84%E5%BA%94%E7%94%A8/" class="article-date">
  <time datetime="2020-06-22T12:07:19.740Z" itemprop="datePublished">2020-06-22</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 class="article-title" itemprop="name">
      Web 应用黑客手册/第四章：映射应用
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h3 id="映射应用"><a href="#映射应用" class="headerlink" title="映射应用"></a>映射应用</h3><p>攻击的第一步是收集和考察应用的核心功能，理解应用。</p>
<h4 id="枚举内容和功能"><a href="#枚举内容和功能" class="headerlink" title="枚举内容和功能"></a>枚举内容和功能</h4><h5 id="Web-爬虫"><a href="#Web-爬虫" class="headerlink" title="Web 爬虫"></a>Web 爬虫</h5><p>Burp Suite</p>
<p>爬虫其实就是图遍历。麻烦之处在于有的网页只有在 post 之后才能看到。</p>
<p>robots.txt 是网站根目录下的文件，用于告诉爬虫工具，本站什么路径可以爬虫，什么路径不可以。在该文件中可以发现一下有趣的信息。比如，<a href="https://github.com/robots.txt，https://www.taobao.com/robots.txt" target="_blank" rel="noopener">https://github.com/robots.txt，https://www.taobao.com/robots.txt</a></p>
<p>缺点：</p>
<ul>
<li>不适应异常的导航机制，尤其是 js 比较多</li>
<li>多阶段功能，比如注册，登录</li>
<li>爬虫工具使用 url 标记网页，有的网页使用 form 实现功能，工具只会爬一次</li>
<li>有的网站需要登录才能访问</li>
</ul>
<p>潜在风险：有的网站比较垃圾，爬虫工具一个万一给删库了就得从入门到入狱了</p>
<h5 id="手动爬虫"><a href="#手动爬虫" class="headerlink" title="手动爬虫"></a>手动爬虫</h5><p>步骤：</p>
<ol>
<li>配置浏览器使用 Burp 代理</li>
<li>正常浏览网站</li>
<li>查看 Burp 的 map</li>
<li>Burp 自动爬虫</li>
</ol>
<h5 id="发现隐藏内容"><a href="#发现隐藏内容" class="headerlink" title="发现隐藏内容"></a>发现隐藏内容</h5><p>备份文件，新功能，调试功能，未移除功能，老版本文件，配置文件，源代码，注释，日志</p>
<h5 id="暴力枚举"><a href="#暴力枚举" class="headerlink" title="暴力枚举"></a>暴力枚举</h5><h5 id="从已发布内容推断"><a href="#从已发布内容推断" class="headerlink" title="从已发布内容推断"></a>从已发布内容推断</h5><p>Hack Steps</p>
<ol>
<li>观察手动+自动+暴力爬虫的结果</li>
<li>识别命名规则</li>
<li>审查客户端内容猜测隐藏的服务端内容</li>
<li>在枚举目录中添加发现的潜在路径</li>
<li>猜测开发人员可能会残留的临时文件</li>
<li>进一步自动爬虫</li>
</ol>
<h5 id="使用公共信息"><a href="#使用公共信息" class="headerlink" title="使用公共信息"></a>使用公共信息</h5><ul>
<li>搜索引擎</li>
<li>快照</li>
</ul>
<p>网站除了包含本站的 URL，也可能包含其他商业伙伴的 URL，比如，包含淘宝链接</p>
<p>Hack Steps</p>
<ol>
<li>使用不同的搜索引擎和快照搜索目标网站</li>
<li>使用高级搜索技巧，site,link,related</li>
<li>在 group 和 news 中搜索</li>
<li>看完之后，重复搜索</li>
<li>查看缓存</li>
<li>在应用的其他域名下查询</li>
</ol>
<p>如果查到了老内容和功能，有可能还在使用，老功能可能有漏洞</p>
<p>即使老功能已经移除，也可以提供线索</p>
<p>还可以从公共论坛上查看别人发的帖子</p>
<h5 id="利用-Web-服务器"><a href="#利用-Web-服务器" class="headerlink" title="利用 Web 服务器"></a>利用 Web 服务器</h5><p>有的 web 服务器的目录遍历漏洞</p>
<p>Niko 工具，用于扫描 web 服务器，检测已有漏洞</p>
<h5 id="发现隐藏内容-1"><a href="#发现隐藏内容-1" class="headerlink" title="发现隐藏内容"></a>发现隐藏内容</h5><p>使用 debug 关键字之类</p>
<h4 id="分析应用"><a href="#分析应用" class="headerlink" title="分析应用"></a>分析应用</h4><h5 id="识别用户输入的入口"><a href="#识别用户输入的入口" class="headerlink" title="识别用户输入的入口"></a>识别用户输入的入口</h5><ul>
<li>URL</li>
<li>URL 查询参数</li>
<li>POST 请求参数</li>
<li>cookie</li>
<li>HTTP 请求头</li>
</ul>
<h6 id="URL-路径"><a href="#URL-路径" class="headerlink" title="URL 路径"></a>URL 路径</h6><p>一般该路径对应 HTTP 请求的文件，但是，REST 风格的 URL 除外，参数也是路径的一部分</p>
<h6 id="请求参数"><a href="#请求参数" class="headerlink" title="请求参数"></a>请求参数</h6><p>一般都是 name=value  的格式，有一些自定义的参数格式，可能会含有意外收获</p>
<h6 id="HTTP-请求头"><a href="#HTTP-请求头" class="headerlink" title="HTTP 请求头"></a>HTTP 请求头</h6><p>HTTP 的 Referer 也可能会被应用作为输入来处理。</p>
<p>应用会根绝 User-Agent 来显示不同的内容，可以尝试。假如把  User-Agent  设置为手机，可能会返回一个简化版页面，更有可能出现问题。</p>
<p>X-Forwarded-For 伪造。</p>
<h6 id="带外信道"><a href="#带外信道" class="headerlink" title="带外信道"></a>带外信道</h6><p>HTTP 可能只是作为 运输层 来使用，比如基于 HTTP 的 SMTP 邮箱服务。</p>
<h6 id="版本信息"><a href="#版本信息" class="headerlink" title="版本信息"></a>版本信息</h6><p>通过 HTTP 响应的 Server header 可以获得服务器的版本信息，除此之外：</p>
<ul>
<li>HTML 模板</li>
<li>自定义 HTTP 头</li>
<li>URL 查询字符串参数</li>
</ul>
<p>都可以用于分析服务器版本信息</p>
<h6 id="HTTP-指纹"><a href="#HTTP-指纹" class="headerlink" title="HTTP 指纹"></a>HTTP 指纹</h6><p>HTTP 协议包含大量可选部分；不同的服务器有各自的特色。Web 服务器版本信息可以通过各种不同的信息区分出来。Httprecon  就是这种工具。</p>
<h6 id="文件扩展名"><a href="#文件扩展名" class="headerlink" title="文件扩展名"></a>文件扩展名</h6><ul>
<li>aspx — Microsoft ASP.NET</li>
<li>aspx — Microsoft ASP.NET</li>
<li>jsp — Java Server Pages</li>
<li>cfm — Cold Fusion</li>
<li>php — The PHP language</li>
<li>d2w — WebSphere</li>
<li>d2w — WebSphere</li>
<li>py — The Python language</li>
<li>dll — Usually compiled native code (C or C++)</li>
<li>nsf or ntf — Lotus Domino</li>
</ul>
<h6 id="会话令牌"><a href="#会话令牌" class="headerlink" title="会话令牌"></a>会话令牌</h6><ul>
<li>JSESSIONID — The Java Platform</li>
<li>ASPSESSIONID — Microsoft IIS server</li>
<li>ASP.NET_SessionId — Microsoft ASP.NET</li>
<li>CFID/CFTOKEN — Cold Fusion</li>
<li>PHPSESSID — PHP</li>
</ul>
<h6 id="第三方代码"><a href="#第三方代码" class="headerlink" title="第三方代码"></a>第三方代码</h6><p>比如，FASTJSON</p>
<h5 id="识别服务端功能"><a href="#识别服务端功能" class="headerlink" title="识别服务端功能"></a>识别服务端功能</h5><h6 id="分析请求"><a href="#分析请求" class="headerlink" title="分析请求"></a>分析请求</h6><h6 id="推测应用程序行为"><a href="#推测应用程序行为" class="headerlink" title="推测应用程序行为"></a>推测应用程序行为</h6><p>一般情况下，一个应用内很多功能是共通的，这点可以利用。</p>
<p>比如，可以利用类似 echo 功能的接口来推测应用所使用的消毒技术来进行 SQL 注入</p>
<h6 id="独特的部分"><a href="#独特的部分" class="headerlink" title="独特的部分"></a>独特的部分</h6><p>和上部分相反，假如某个部分和某应用主流风格不一致，那就可能是应用安全框架之外的漏网之鱼</p>
<h6 id="映射攻击面"><a href="#映射攻击面" class="headerlink" title="映射攻击面"></a>映射攻击面</h6><ul>
<li>Client-side validation — Checks may not be replicated on the server</li>
<li>Database interaction — SQL injection</li>
<li>File uploading and downloading — Path traversal vulnerabilities, stored cross-site scripting</li>
<li>Display of user-supplied data — Cross-site scripting</li>
<li>Dynamic redirects — Redirection and header injection attacks</li>
<li>Social networking features — username enumeration, stored cross-site scripting</li>
<li>Login — Username enumeration, weak passwords, ability to use brute force</li>
<li>Multistage login — Logic flaws</li>
<li>Session state — Predictable tokens, insecure handling of tokens</li>
<li>Access controls — Horizontal and vertical privilege escalation</li>
<li>User impersonation functions — Privilege escalation</li>
<li>Use of cleartext communications — Session hijacking, capture of credentials and other sensitive data</li>
<li>Off-site links — Leakage of query string parameters in the Referer header</li>
<li>Interfaces to external systems — Shortcuts in the handling of sessions and/or access controls</li>
<li>Error messages — Information leakage</li>
<li>E-mail interaction — E-mail and/or command injection</li>
<li>Native code components or interaction — Buffer overflows</li>
<li>Use of third-party application components — Known vulnerabilities</li>
<li>Identifiable web server software — Common configuration weaknesses, known software bugs</li>
</ul>
<h5 id="作业"><a href="#作业" class="headerlink" title="作业"></a>作业</h5>
      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2020/06/22/Web%20%E5%BA%94%E7%94%A8%E9%BB%91%E5%AE%A2%E6%89%8B%E5%86%8C/%E7%AC%AC%E5%9B%9B%E7%AB%A0%EF%BC%9A%E6%98%A0%E5%B0%84%E5%BA%94%E7%94%A8/" data-id="ckbxqp6f40007rsfe37bb9lnf" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
    
<nav id="article-nav">
  
    <a href="/2020/06/25/Web%20%E5%BA%94%E7%94%A8%E9%BB%91%E5%AE%A2%E6%89%8B%E5%86%8C/%E7%AC%AC%E4%BA%94%E7%AB%A0%EF%BC%9A%E7%BB%95%E8%BF%87%E5%AE%A2%E6%88%B7%E7%AB%AF%E6%8E%A7%E5%88%B6/" id="article-nav-newer" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Newer</strong>
      <div class="article-nav-title">
        
          Web 应用黑客手册/第五章：绕过客户端控制
        
      </div>
    </a>
  
  
    <a href="/2020/06/21/Web%20%E5%BA%94%E7%94%A8%E9%BB%91%E5%AE%A2%E6%89%8B%E5%86%8C/%E7%AC%AC%E4%B8%89%E7%AB%A0%EF%BC%9AWeb%20%E5%BA%94%E7%94%A8%E6%8A%80%E6%9C%AF/" id="article-nav-older" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Older</strong>
      <div class="article-nav-title">Web 应用黑客手册/第三章：Web 应用技术</div>
    </a>
  
</nav>

  
</article>

</section>
        
          <aside id="sidebar">
  
    

  
    

  
    
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Archives</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/07/">July 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/06/">June 2020</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Recent Posts</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2020/07/09/Web%20%E5%BA%94%E7%94%A8%E9%BB%91%E5%AE%A2%E6%89%8B%E5%86%8C/%E7%AC%AC%E5%8D%81%E4%BA%8C%E7%AB%A0%EF%BC%9A%E6%94%BB%E5%87%BB%E7%94%A8%E6%88%B7%EF%BC%9A%E8%B7%A8%E7%AB%99%E8%84%9A%E6%9C%AC/">Web 应用黑客手册/第十二章：攻击用户：跨站脚本</a>
          </li>
        
          <li>
            <a href="/2020/07/01/Web%20%E5%BA%94%E7%94%A8%E9%BB%91%E5%AE%A2%E6%89%8B%E5%86%8C/%E7%AC%AC%E5%8D%81%E4%B8%80%E7%AB%A0%EF%BC%9A%E6%94%BB%E5%87%BB%E5%BA%94%E7%94%A8%E9%80%BB%E8%BE%91/">Web 应用黑客手册/第十一章：攻击应用逻辑</a>
          </li>
        
          <li>
            <a href="/2020/06/27/Web%20%E5%BA%94%E7%94%A8%E9%BB%91%E5%AE%A2%E6%89%8B%E5%86%8C/%E7%AC%AC%E5%8D%81%E7%AB%A0%EF%BC%9A%E6%94%BB%E5%87%BB%E5%90%8E%E7%AB%AF%E7%BB%84%E4%BB%B6/">Web 应用黑客手册/第十章：攻击后端组件</a>
          </li>
        
          <li>
            <a href="/2020/06/26/Web%20%E5%BA%94%E7%94%A8%E9%BB%91%E5%AE%A2%E6%89%8B%E5%86%8C/%E7%AC%AC%E4%B9%9D%E7%AB%A0%EF%BC%9A%E6%94%BB%E5%87%BB%E6%95%B0%E6%8D%AE%E5%AD%98%E5%82%A8/">Web 应用黑客手册/第九章：攻击数据存储</a>
          </li>
        
          <li>
            <a href="/2020/06/26/Web%20%E5%BA%94%E7%94%A8%E9%BB%91%E5%AE%A2%E6%89%8B%E5%86%8C/%E7%AC%AC%E5%85%AB%E7%AB%A0%EF%BC%9A%E6%94%BB%E5%87%BB%E8%AE%BF%E9%97%AE%E6%8E%A7%E5%88%B6/">Web 应用黑客手册/第八章：攻击访问控制</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2020 John Doe<br>
      Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>
    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    

<script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>


  
<link rel="stylesheet" href="/fancybox/jquery.fancybox.css">

  
<script src="/fancybox/jquery.fancybox.pack.js"></script>




<script src="/js/script.js"></script>




  </div>
</body>
</html>